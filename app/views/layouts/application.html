<html lang="en">
<head>
  <meta charset="utf8">
  <title>Community Circlres</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
  <link rel="stylesheet" href="/components/leaflet-dist/leaflet.css">
  <link rel="stylesheet" href="/components/angular-carousel/dist/angular-carousel.min.css">
  <link rel="stylesheet" href="/vendor/fontawesome/css/font-awesome.min.css">
  <link rel="stylesheet" href="/vendor/linecons/style.css">
  <link rel="stylesheet" href="/vendor/icomatic/icomatic.css">
  <link rel="stylesheet" href="/stylesheets/<%= yield.controller %>.css">

  <!-- Cordova -->
  <script src="http://localhost/cordova.js"></script>

  <!-- Basic libraries -->
  <script src="/components/steroids-js/steroids.js"></script>
  <script src="/components/holderjs/holder.js"></script>
  <script src="/components/d3/d3.min.js"></script>
  <script src="/components/underscore/underscore-min.js"></script>
  <script src="/components/moment/moment.js"></script>
  <script src="/components/leaflet-dist/leaflet.js"></script>
  <script src="/components/angular/angular.min.js"></script>

  <!-- Plugins -->
  <script src="/components/restangular/dist/restangular.min.js"></script>
  <script src="/components/angular-moment/angular-moment.js"></script>
  <script src="/components/angular-animate/angular-animate.min.js"></script>
  <script src="/components/angular-touch/angular-touch.min.js"></script>
  <script src="/components/angular-carousel/dist/angular-carousel.min.js"></script>
  <script src="/components/leaflet.markercluster/dist/leaflet.markercluster.js"></script>

  <!-- Custom components -->
  <script src="/vendor/oms/oms.min.js"></script>
  <script src="/vendor/angular-swipe/angular-swipe.js"></script>
  <script src="/vendor/maskcanvas/QuadTree.js"></script>
  <script src="/vendor/maskcanvas/L.TileLayer.MaskCanvas.js"></script>

  <!-- App code -->
  <script src="/community-circles/keys.js"></script>
  <script src="/community-circles/base.js"></script>
  <script src="/community-circles/util.js"></script>
  <script src="/community-circles/game.js"></script>
  <script src="/community-circles/log.js"></script>
  <script src="/models/models.js"></script>
  <script src="/controllers/<%= yield.controller %>.js"></script>

  <script>
    // http://stackoverflow.com/questions/12106355/disable-permanent-active-state
    (function(){
        var previousOnload = window.onload || function noop() {};

        window.onload = function () {

            // Call any previously added onload callbacks
            previousOnload();

            var elements = document.getElementsByClassName("touchfix");
            for (var i=0; i<elements.length; i++){
              elements[i].addEventListener("touchend", deactivate, false);
              elements[i].addEventListener("touchcancel", deactivate, false);
            }

            function deactivate() {
              steroids.logger.log("deactivate()");
              element = this
              setTimeout(function() {
                var parent   = element.parentNode,
                    position = element.nextSibling;
                parent.removeChild(element);
                // Using insertBefore instead of appendChild so that it is put at the right position among the siblings
                parent.insertBefore(element, position);
                }, 200);
            }
        };

    })();
  </script>
</head>
<body>
  <%= yield.view %>
</body>
</html>